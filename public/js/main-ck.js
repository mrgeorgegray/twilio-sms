$(function(){function e(e){return decodeURIComponent(((new RegExp("[?|&]"+e+"="+"([^&;]+?)(&|#|;|$)")).exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}var t=e("status");if(t==="sent"){$("body").addClass("green");$("#response").html("<p>Message sent!</p>")}else if(t==="error"){$("body").addClass("red");$("#response").html("<p>Something went wrong</p>")}if(navigator.geolocation){var n={center:new google.maps.LatLng(-36.3,-41.1),zoom:8,mapTypeId:google.maps.MapTypeId.ROADMAP},r=new google.maps.Map(document.getElementById("map-canvas"),n),i=new google.maps.InfoWindow({content:"<p>Your location.</p>"});navigator.geolocation.getCurrentPosition(function(e){var t=e.coords.latitude,n=e.coords.longitude,s=new google.maps.LatLng(t,n);r.setCenter(s);r.setZoom(14);var o=new google.maps.Marker({position:s,map:r});$.getJSON("http://maps.googleapis.com/maps/api/geocode/json?latlng="+t+","+n+"&sensor=false",function(e){var t=e.results[0],n=t.formatted_address;google.maps.event.addListener(o,"click",function(){i.setContent('<div class="info-window"><h2>You are here</h2><p>'+n+"</p>");i.open(r,o)});var s='<a class="btn" href="https://maps.google.co.uk/maps?q='+n+'">Google Maps location</a>';$("#status").html('<form class="send_sms" action ="/sms" method ="post"><input class="location" name="location" type="hidden" value="You can find me at '+n+'" />'+'<label for="phone">SMS your location</label>'+'<input id="phone" name="phone" type="text" placeholder="Enter number..."/>'+'<input type="submit" value="Send"></input>'+"</form>");$("#map-canvas").after(s)})})}else{$("body").addClass("red");$("#status").html("<p>Sorry your browser doesn't support Geolocation")}});